<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/images/favicon.png">
    <title>å›¾ç‰‡APIæ¥å£æ–‡æ¡£</title>
    <!-- ============== æ ¸å¿ƒé…ç½®åŒºã€æœ€é¡¶éƒ¨ï¼Œæ–¹ä¾¿ä¿®æ”¹ã€‘ ============== -->
    <script>
        // å›¾ç‰‡APIä¸»æ¥å£åœ°å€ã€ç›´æ¥ä¿®æ”¹è¿™é‡Œå³å¯ã€‘
        const API_BASE_URL = 'http://pt.tzjsy.cn/4k/img.php';
        // å¿…åº”èƒŒæ™¯å›¾æ¥å£åœ°å€ã€å·²ä¿®æ”¹ä¸ºæ–°åœ°å€ã€‘
        const BING_API_URL = 'http://pt.tzjsy.cn/bing/img.php';
    </script>
</head>
<body>
    <!-- ============== HTMLä¸»ç¨‹åºç»“æ„ã€ä¸­é—´æ ¸å¿ƒåŒºåŸŸã€‘ ============== -->
    <div id="snow-container"></div>

    <div class="container">
        <div class="header">
            <h1>å›¾ç‰‡APIæ¥å£æ–‡æ¡£</h1>
            <p>éšæœºå›¾ç‰‡è·å–æœåŠ¡ Â· é«˜æ•ˆç¨³å®š Â· å¤šåœºæ™¯é€‚é…</p>
        </div>

        <div class="main-row">
            <!-- å·¦ä¾§æ¥å£è¯´æ˜ -->
            <div class="left-content">
                <div class="content">
                    <div class="section">
                        <h2>æ¥å£æ¦‚è§ˆ</h2>
                        <div class="api-info">
                            <div class="api-item">
                                <strong>è¯·æ±‚æ–¹å¼:</strong>
                                <span class="method-get">GET</span>
                            </div>
                            <div class="api-item">
                                <strong>è¿”å›æ ¼å¼:</strong>
                                <span class="format-json">JSON/å›¾ç‰‡æµ</span>
                            </div>
                            <div class="api-item">
                                <strong>æ¥å£åœ°å€:</strong>
                                <span class="clickable-link" id="apiMainLink"></span>
                            </div>
                            <div class="api-item">
                                <strong>çŠ¶æ€ç :</strong>
                                <span>200</span>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2>è¿”å›å‚æ•°è¯´æ˜</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>å‚æ•°å</th>
                                    <th>ç±»å‹</th>
                                    <th>æè¿°</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>code</td>
                                    <td>Number</td>
                                    <td>200æˆåŠŸ / 404å¤±è´¥</td>
                                </tr>
                                <tr>
                                    <td>msg</td>
                                    <td>String</td>
                                    <td>çŠ¶æ€æè¿°ä¿¡æ¯</td>
                                </tr>
                                <tr>
                                    <td>data</td>
                                    <td>String</td>
                                    <td>å›¾ç‰‡æœ‰æ•ˆè®¿é—®åœ°å€</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="section">
                        <h2>è¿”å›ç¤ºä¾‹</h2>
                        <div class="response-example">
                            <h3>æˆåŠŸè¿”å›ï¼š</h3>
                            <pre id="successResponse">{
  "code": <span id="realCode">200</span>,
  "msg": "<span id="realMsg">è¯·æ±‚æˆåŠŸ</span>",
  "data": "<span class="clickable-link" id="realImageLink"></span>"
}</pre>
                        </div>
                        <div class="response-example error">
                            <h3>å¤±è´¥è¿”å›ï¼š</h3>
                            <pre>{
  "code": 404,
  "msg": "æœªæ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶ã€‚",
  "data": null
}</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§é¢„è§ˆ+åŠŸèƒ½ -->
            <div class="right-section">
                <div class="image-preview-container">
                    <h3 class="image-preview-title">æ¥å£å®æ—¶é¢„è§ˆï¼ˆç‚¹å‡»åˆ·æ–°ï¼‰</h3>
                    <div class="image-frame" id="imageFrame">
                        <div class="loading">æ­£åœ¨åŠ è½½å›¾ç‰‡...</div>
                    </div>
                </div>

                <div class="features">
                    <div class="feature-card">
                        <h3>âœ… éšæœºæ— é‡å¤</h3>
                        <p>ä»æŒ‡å®šæ–‡ä»¶å¤¹éšæœºè¿”å›ï¼Œé¿å…è¿ç»­é‡å¤</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ”’ ä¼šè¯æ§åˆ¶</h3>
                        <p>Sessionè®°å½•ä¸Šä¸€å¼ ï¼Œé˜²æ­¢é‡å¤æ˜¾ç¤º</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸŒ åŒæ ¼å¼è¿”å›</h3>
                        <p>æµè§ˆå™¨â†’å›¾ç‰‡æµï¼Œæ¥å£â†’JSONï¼Œå¤šåœºæ™¯é€‚é…</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ“± åŠ¨æ€åœ°å€</h3>
                        <p>è‡ªåŠ¨æå–åŸŸå+å­ç›®å½•ï¼Œéƒ¨ç½²å…æ”¹é…ç½®</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨å¤‡æ¡ˆä¿¡æ¯ -->
    <div class="footer-record">
      <a href="https://beian.miit.gov.cn/" target="_blank" style="text-decoration:none;" rel="noopener">
        <img src="/images/icp.png" style="width:15px;height:15px;vertical-align:middle;margin-right:6px;">
        <span style="color:#222; font-size:14px; font-weight:500; vertical-align:middle;">æ²ªICPå¤‡00000001å·</span>
      </a>
      <a href="https://beian.mps.gov.cn/#/query/webSearch?code=è‡ªå·±çš„å¤‡æ¡ˆid" target="_blank" style="text-decoration:none;" rel="noopener">
        <img src="/images/beian.png" style="width:15px;height:15px;vertical-align:middle;margin-right:6px;">
        <span style="color:#222; font-size:14px; font-weight:500; vertical-align:middle;">æ²ªå…¬ç½‘å®‰å¤‡00000000000001å·</span>
      </a>
    </div>

    <!-- ============== æ‰€æœ‰CSSæ ·å¼ã€ç§»åˆ°HTMLä¸‹æ–¹ï¼Œå¤‡æ¡ˆä¸Šæ–¹ã€‘ ============== -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Microsoft YaHei',sans-serif;
            line-height: 1.6;
            color: #333;
            background: transparent;
            min-height: 100vh;
            padding: 8px;
            background-position: center;
            background-size: cover;
            background-attachment: fixed;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(255,255,255,0.7);
            z-index: -2;
            pointer-events: none;
        }

        /* é£˜é›ªåŠ¨ç”» */
        #snow-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }
        .snowflake {
            position: absolute;
            color: #fff;
            font-size: 16px;
            opacity: 0;
            animation: snowfall linear infinite;
            text-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        @keyframes snowfall {
            0%   { transform: translate(0,0) rotate(0deg); opacity: 0; }
            10%  { opacity: 1; }
            90%  { opacity: 1; }
            100% { transform: translate(50px, 100vh) rotate(360deg); opacity: 0; }
        }

        /* ä¸»å®¹å™¨æ ·å¼ */
        .container {
            max-width: 1600px;
            width: 100%;
            margin: 0 auto;
            background: rgba(255,255,255, 0.22);
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            overflow: hidden;
            position: relative;
            z-index: 10;
            padding: 8px;
            margin-bottom: 12px;
            flex: 1;
        }

        /* é¡¶éƒ¨æ ‡é¢˜æ  */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 16px 12px;
            text-align: center;
            border-radius: 6px;
            margin-bottom: 12px;
        }
        .header h1 { font-size: 1.9em; margin-bottom: 6px; font-weight: 600; }
        .header p { font-size: 1em; opacity: 0.95; }

        /* å·¦å³åˆ†æ å¸ƒå±€ */
        .main-row {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        .left-content {
            flex: 0 0 43%;
            min-width: 320px;
        }
        .right-section {
            flex: 1;
            min-width: 420px;
            position: sticky;
            top: 20px;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        /* å†…å®¹é€šç”¨æ ·å¼ */
        .content { padding: 12px 10px; }
        .section { margin-bottom: 18px; }
        .section h2 {
            color: #556cd6;
            border-bottom: 2px solid rgba(238,238,238,0.8);
            padding-bottom: 8px;
            margin-bottom: 14px;
            font-size: 1.4em;
        }

        /* æ¥å£ä¿¡æ¯å¡ç‰‡ */
        .api-info {
            background: rgba(255,255,255,0.65);
            padding: 14px;
            border-radius: 6px;
        }
        .api-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: rgba(255,255,255,0.8);
            border: 1px solid rgba(233,236,239,0.7);
            border-radius: 5px;
            margin-bottom: 8px;
        }
        .api-item strong { width: 110px; color: #222; }
        .method-get { background: #d4edda; color: #155724; padding: 3px 7px; border-radius: 3px; font-size: 0.9em; }
        .format-json { background: #cce5ff; color: #004085; padding: 3px 7px; border-radius: 3px; font-size: 0.9em; }

        /* è¡¨æ ¼æ ·å¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 14px 0;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid rgba(221,221,221,0.7);
            padding: 9px 10px;
            text-align: left;
        }
        th { background: rgba(248,249,250,0.7); }

        /* è¿”å›ç¤ºä¾‹æ ·å¼ */
        .response-example {
            background: rgba(255,255,255,0.6);
            padding: 14px;
            border-radius: 6px;
            border-left: 3px solid #28a745;
            margin-bottom: 12px;
        }
        .response-example h3 { margin-bottom: 8px; font-size: 1.1em; }
        pre {
            background: rgba(248,249,250,0.8);
            padding: 12px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9em;
            line-height: 1.5;
        }
        .response-example.error {
            border-left-color: #dc3545;
            background: rgba(248,215,218,0.6);
        }
        .response-example.error pre { background: rgba(248,215,218,0.7); }

        /* å¯ç‚¹å‡»é“¾æ¥æ ·å¼ */
        .clickable-link {
            color: #0066cc;
            font-weight: bold;
            word-break: break-all;
            text-decoration: underline;
            cursor: pointer;
        }
        .clickable-link:hover { color: #004c99; text-decoration: none; }

        /* å›¾ç‰‡é¢„è§ˆå®¹å™¨ */
        .image-preview-container {
            background: rgba(255,255,255,0.65);
            padding: 18px;
            border-radius: 8px;
            border: 1px solid rgba(221,221,221,0.7);
        }
        .image-preview-title {
            text-align: center;
            margin-bottom: 12px;
            font-size: 1.1em;
            color: #222;
            font-weight: 500;
        }
        .image-frame {
            width: 100%;
            height: 500px;
            border: 1px solid rgba(221,221,221,0.7);
            border-radius: 8px;
            background: rgba(255,255,255,0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 12px;
            position: relative;
            overflow: hidden;
        }
        .chrome-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .loading { text-align: center; padding: 20px; color: #444; font-size: 0.95em; }
        .error-message { color: #c82333; text-align: center; padding: 20px; line-height: 1.7; font-size: 0.95em; }

        /* åŠŸèƒ½ç‰¹æ€§å¡ç‰‡ */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            background: rgba(255,255,255,0.65);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid rgba(221,221,221,0.7);
        }
        .feature-card {
            background: rgba(255,255,255,0.8);
            padding: 14px;
            border-radius: 6px;
            border: 1px solid rgba(233,236,239,0.7);
        }
        .feature-card h3 {
            color: #556cd6;
            margin-bottom: 8px;
            font-size: 1.1em;
            font-weight: 600;
        }
        .feature-card p { 
            font-size: 0.95em;
            line-height: 1.5; 
            color: #333;
        }

        /* åº•éƒ¨å¤‡æ¡ˆå®¹å™¨ */
        .footer-record {
            max-width: 1600px;
            width: 100%;
            margin: 0 auto 12px;
            background: rgba(255,255,255,0.65);
            border-radius: 8px;
            padding: 14px 20px;
            text-align: center;
            border: 1px solid rgba(221,221,221,0.7);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 28px;
            flex-wrap: wrap;
        }

        /* è‡ªé€‚åº”åª’ä½“æŸ¥è¯¢ - å…¨è®¾å¤‡å…¼å®¹ */
        @media (max-width: 1100px) {
            .left-content  { flex: 0 0 42%; }
            .right-section { min-width: 380px; }
            .image-frame { height: 470px; }
        }
        @media (max-width: 920px) {
            .left-content  { flex: 0 0 40%; }
            .right-section { min-width: 350px; }
            .image-frame { height: 440px; }
        }
        @media (max-width: 768px) {
            .main-row { flex-direction: column; gap: 20px; }
            .left-content, .right-section { flex: 0 0 100%; min-width: auto; width: 100%; }
            .right-section { position: static; gap: 16px; }
            .image-frame { height: 360px; }
            .snowflake { font-size: 10px; }
            .features { grid-template-columns: 1fr 1fr; }
            .footer-record { gap: 16px; padding: 12px 14px; }
        }
        @media (max-width: 480px) {
            .features { grid-template-columns: 1fr; }
            .image-frame { height: 300px; }
            .footer-record { flex-direction: column; gap: 10px; padding: 12px 10px; }
        }
    </style>

    <!-- ============== æ‰€æœ‰JSè„šæœ¬ã€ç§»åˆ°é¡µé¢æœ€åº•éƒ¨ï¼Œæœ€ååŠ è½½ã€‘ ============== -->
    <script>
        // ç›´æ¥å¤ç”¨é¡¶éƒ¨å…¨å±€é…ç½®å˜é‡ï¼Œæ— é‡å¤å®šä¹‰
        const apiMainLink    = document.getElementById('apiMainLink');
        const realCode       = document.getElementById('realCode');
        const realMsg        = document.getElementById('realMsg');
        const realImageLink  = document.getElementById('realImageLink');
        const imageFrame     = document.getElementById('imageFrame');

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œåˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', async () => {
            await setBingBackground();
            await setAllDynamicUrl();
            loadPreviewImage();
            startSnowfall();
        });

        // é¢„è§ˆå›¾ç‚¹å‡»åˆ·æ–°
        imageFrame.onclick = loadPreviewImage;

        // æ¥å£åœ°å€é“¾æ¥æ–°çª—å£æ‰“å¼€
        apiMainLink.onclick = realImageLink.onclick = (e) => {
            if (!e.target.innerText) return;
            window.open(e.target.innerText, '_blank');
        };

        // è®¾ç½®å¿…åº”èƒŒæ™¯å›¾ - é€‚é…æ–°æ¥å£ï¼ˆè‡ªåŠ¨åˆ¤æ–­è¿”å›ç±»å‹ï¼‰
        async function setBingBackground() {
            try {
                // å…ˆå°è¯•ä»¥å›¾ç‰‡æ–¹å¼åŠ è½½ï¼ˆæ–°æ¥å£å¯èƒ½ç›´æ¥è¿”å›å›¾ç‰‡æµï¼‰
                const img = new Image();
                img.src = `${BING_API_URL}?t=${+new Date()}`; // æ—¶é—´æˆ³é˜²ç¼“å­˜
                
                img.onload = () => {
                    document.body.style.backgroundImage = `url(${img.src})`;
                };
                
                img.onerror = async () => {
                    // å¦‚æœå›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œå°è¯•ä»¥JSONæ–¹å¼è¯·æ±‚
                    try {
                        const response = await fetch(`${BING_API_URL}?t=${+new Date()}`);
                        // åˆ¤æ–­å“åº”ç±»å‹
                        const contentType = response.headers.get('content-type');
                        
                        if (contentType && contentType.includes('json')) {
                            const data = await response.json();
                            const imgUrl = data.imgurl || data.url || data.data;
                            if (imgUrl) {
                                document.body.style.backgroundImage = `url(${imgUrl})`;
                            } else {
                                throw new Error('æœªè·å–åˆ°å›¾ç‰‡åœ°å€');
                            }
                        } else {
                            // å¦‚æœæ˜¯å…¶ä»–ç±»å‹ï¼Œç›´æ¥ä½œä¸ºå›¾ç‰‡åœ°å€ä½¿ç”¨
                            const blobUrl = URL.createObjectURL(await response.blob());
                            document.body.style.backgroundImage = `url(${blobUrl})`;
                        }
                    } catch (e) {
                        // æ‰€æœ‰æ–¹å¼éƒ½å¤±è´¥æ—¶ä½¿ç”¨æ¸å˜èƒŒæ™¯å…œåº•
                        document.body.style.background = 'linear-gradient(135deg, #f5f7fa, #c3cfe2)';
                    }
                };
            } catch (e) {
                document.body.style.background = 'linear-gradient(135deg, #f5f7fa, #c3cfe2)';
            }
        }

        // åŠ¨æ€è·å–å¹¶è®¾ç½®æ¥å£åœ°å€
        async function setAllDynamicUrl() {
            try {
                const realUrl = await getBrowserRealImageUrl();
                const u = new URL(realUrl);
                const parts = u.pathname.split('/').filter(p=>p);
                const base = parts[0] ? `${u.origin}/${parts[0]}` : u.origin;
                const final = `${base}/img.php`;
                apiMainLink.innerText = final;
                realImageLink.innerText = final;
            } catch (e) {
                apiMainLink.innerText = API_BASE_URL;
                realImageLink.innerText = API_BASE_URL;
            }
        }

        // è·å–æµè§ˆå™¨ç«¯çœŸå®å›¾ç‰‡æ¥å£åœ°å€
        function getBrowserRealImageUrl() {
            return new Promise((res, rej) => {
                const img = new Image();
                img.src = `${API_BASE_URL}?t=${+new Date()}`;
                img.onload = () => res(img.src);
                img.onerror = rej;
                setTimeout(() => rej('timeout'), 5000);
            });
        }

        // åŠ è½½/åˆ·æ–°é¢„è§ˆå›¾ç‰‡
        function loadPreviewImage() {
            imageFrame.innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';
            const img = new Image();
            img.className = 'chrome-image';
            img.src = `${API_BASE_URL}?t=${+new Date()}`; // æ—¶é—´æˆ³é˜²ç¼“å­˜
            img.onload = () => {
                imageFrame.innerHTML = '';
                imageFrame.appendChild(img);
            };
            img.onerror = () => {
                imageFrame.innerHTML = `<div class="error-message">é¢„è§ˆåŠ è½½å¤±è´¥<br>æ£€æŸ¥æ¥å£/ç½‘ç»œ/CORS</div>`;
            };
        }

        // é£˜é›ªåŠ¨ç”»åˆå§‹åŒ–
        function startSnowfall() {
            const container = document.getElementById('snow-container');
            const count = innerWidth > 768 ? 80 : 40;
            const chars = ['ğŸŒ™','â…','â†','â­','â¤ï¸'];
            for(let i=0; i<count; i++){
                const s = document.createElement('div');
                s.className = 'snowflake';
                s.innerText = chars[Math.random()*chars.length|0];
                s.style.left = Math.random()*100+'%';
                s.style.top = (Math.random()*-50-10)+'px';
                s.style.animationDuration = (Math.random()*12+6)+'s';
                s.style.animationDelay = (Math.random()*10)+'s';
                s.style.transform = `scale(${Math.random()*0.7+0.4})`;
                container.appendChild(s);
            }
        }
    </script>
</body>
</html>